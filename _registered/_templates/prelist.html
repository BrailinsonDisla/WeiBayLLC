{% extends 'base.html' %}

{% block head %}
    <title>Listing Form</title>
    <link href="/static/styles/_default/prelist.css" rel="stylesheet">
{% endblock %}

{% block body %}
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="/profile">Homepage</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
            </ul>
        </div>
    </nav>
    <h1>Start your listing</h1>
    
    <form action="">
        <div class="container">
            <div class="row">
                <div class="col-6">
                    <div class="form-group">
                        <label for="item-name" class="form-label">Item Title</label><br>
                        <input type="text" class="form-control" name="item-name" id="item-name" placeholder="Tell us what you're selling">
                    </div>
                    <div>
                        <label for="item-condition" class="form-label">Item Condition</label><br>
                        <select class="form-control" name="item-condition" id="item-condition">
                            <option>New</option>
                            <option>Open Box</option>
                            <option>Used</option>
                        </select>
                    </div>
                    <div>
                        <label for="item-price" class="form-label">Price</label>
                        <input type="number" class="form-control" name="item-price" id="item-price">
                    </div>
                </div>
                <div class="col-6">
                    <div>
                        <label for="item-description" class="form-label">Item Description</label>
                        <textarea class="form-control" name="item-description" id="item-description" rows="3" placeholder="Tell us about what you're selling"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="image-upload">Upload Images</label>
                        <input type="file" class="form-control-file" id="drop-area" ondrop="dropHandler(event)" ondragover="dragOverHandler(event)"
                        ondragleave="dragLeaveHandler(event)" multiple>
                            <p>Drop files here to upload</p>
                        </div>
                    </div>
                    <div id="image-preview"></div>
                </div>
            </div>
            <div class="row">
                <button type="submit" id="submit" class="btn btn-primary">submit</button>
            </div>
        </div>
    </form>
    <script>
        function dragOverHandler(event) {
            // Prevent the default behavior (previewing the file in the browser)
            event.preventDefault();
            
            // Add the highlight class to the drop area
            const dropArea = document.getElementById('drop-area');
            dropArea.classList.add('highlight');
        }
        
        function dragLeaveHandler(event) {
            // Remove the highlight class from the drop area
            const dropArea = document.getElementById('drop-area');
            dropArea.classList.remove('highlight');
        }
        
        function dropHandler(event) {
            // Prevent the default behavior (opening the file in the browser)
            event.preventDefault();
            
            // Get the files that were dropped
            const files = event.dataTransfer.files;
            
            // Create an HTML fragment to hold the previews
            const fragment = document.createDocumentFragment();
            
            // Loop through the files and create a preview for each
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                
                // Create an image element to preview the file
                const img = document.createElement('img');
                img.classList.add('img-thumbnail');
                
                // Use the FileReader API to read the file and set the src of the image
                const reader = new FileReader();
                reader.onload = function(event) {
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
          
                // Add the image to the HTML fragment
                fragment.appendChild(img);
            }
            
            // Add the fragment to the page
            const preview = document.getElementById('image-preview');
            preview.innerHTML = '';
            preview.appendChild(fragment);
        }
    </script>
</body>
{% endblock %}